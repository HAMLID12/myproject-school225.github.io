<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –º–∞–∫–µ—Ç–∞ —Å–∞–π—Ç–∞</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Montserrat', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #1a1a2e;
            background-image: radial-gradient(circle at 25% 50%, #4a4a8a 0%, #1a1a2e 100%);
            overflow: hidden;
            color: #ecf0f1;
            min-height: 100vh;
        }

        .container {
            display: flex;
            height: 100vh;
            width: 100%;
            position: relative;
        }

        /* –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ */
        .sidebar {
            width: 250px;
            background-color: #2c3e50;
            color: white;
            padding: 25px;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            z-index: 100;
            box-shadow: 5px 0 15px rgba(0, 0, 0, 0.2);
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 30px;
            text-align: center;
            color: #ecf0f1;
            background: linear-gradient(45deg, #ff7e5f, #feb47b);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            position: relative;
            padding-bottom: 10px;
        }

        .logo::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 3px;
            background: linear-gradient(to right, #ff7e5f, #feb47b);
            border-radius: 2px;
        }

        .tool-button {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 14px 20px;
            border-radius: 8px;
            margin-bottom: 15px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: flex-start;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .tool-button i {
            margin-right: 12px;
            font-size: 20px;
        }

        .tool-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.25);
        }

        .tool-button:active {
            transform: translateY(1px);
        }

        /* –ü–∞–Ω–µ–ª—å —Å–≤–æ–π—Å—Ç–≤ –æ–±—ä–µ–∫—Ç–∞ (—Å–ø—Ä–∞–≤–∞) */
        .properties-panel {
            width: 280px;
            background-color: #2c3e50;
            padding: 25px;
            overflow-y: auto;
            border-left: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: -5px 0 15px rgba(0, 0, 0, 0.2);
        }

        .property-group {
            margin-bottom: 25px;
            background-color: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #3498db;
        }

        .property-title {
            font-weight: 600;
            margin-bottom: 15px;
            font-size: 16px;
            color: #ecf0f1;
            padding-bottom: 8px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .property-control {
            margin-bottom: 20px;
        }

        .property-control:last-child {
            margin-bottom: 0;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #bdc3c7;
            font-size: 14px;
        }

        input, select {
            width: 100%;
            padding: 10px 12px;
            background-color: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            font-size: 14px;
            color: #ecf0f1;
            transition: all 0.3s;
        }

        input:focus, select:focus {
            border-color: #3498db;
            outline: none;
            background-color: rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.3);
        }

        .color-picker {
            width: 100%;
            height: 45px;
            padding: 0;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            cursor: pointer;
            background: transparent;
        }

        /* –û—Å–Ω–æ–≤–Ω–æ–π —Ö–æ–ª—Å—Ç */
        .canvas-container {
            flex-grow: 1;
            position: relative;
            background-color: rgba(0, 0, 0, 0.2);
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .canvas {
            background-color: white;
            position: relative;
            width: 1200px;
            height: 800px;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.3);
            transform-origin: center;
            overflow: visible;
            transition: transform 0.2s;
        }

        /* –î–∏–∞–ª–æ–≥–æ–≤–æ–µ –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ —Ñ–∏–≥—É—Ä */
        .shapes-dialog {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #2c3e50;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4);
            padding: 30px;
            width: 550px;
            max-height: 80vh;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .dialog-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 15px;
        }

        .dialog-title {
            font-size: 22px;
            font-weight: 600;
            color: #ecf0f1;
            background: linear-gradient(45deg, #ff7e5f, #feb47b);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .close-dialog {
            background: none;
            border: none;
            font-size: 26px;
            cursor: pointer;
            color: #7f8c8d;
            transition: color 0.3s;
        }

        .close-dialog:hover {
            color: #e74c3c;
        }

        .shapes-list {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }

        .shape-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            padding: 20px;
            border-radius: 10px;
            transition: all 0.3s;
            background-color: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .shape-item:hover {
            background-color: rgba(255, 255, 255, 0.1);
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
        }

        .shape-preview {
            width: 80px;
            height: 80px;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 12px;
        }

        .shape-name {
            font-size: 15px;
            text-align: center;
            color: #ecf0f1;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ —Ö–æ–ª—Å—Ç–µ */
        .canvas-element {
            position: absolute;
            cursor: move;
            user-select: none;
        }

        .canvas-element.selected {
            outline: 3px solid #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.3);
        }

        .resize-handle {
            position: absolute;
            width: 12px;
            height: 12px;
            background: linear-gradient(45deg, #3498db, #2980b9);
            border: 2px solid white;
            border-radius: 50%;
            z-index: 10;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .resize-handle.top-left {
            top: -6px;
            left: -6px;
            cursor: nwse-resize;
        }

        .resize-handle.top-right {
            top: -6px;
            right: -6px;
            cursor: nesw-resize;
        }

        .resize-handle.bottom-left {
            bottom: -6px;
            left: -6px;
            cursor: nesw-resize;
        }

        .resize-handle.bottom-right {
            bottom: -6px;
            right: -6px;
            cursor: nwse-resize;
        }

        .canvas-text {
            min-width: 60px;
            min-height: 30px;
            padding: 8px;
            border: 1px dashed transparent;
            outline: none;
            color: #333;
        }

        .canvas-text:hover {
            border-color: #ddd;
        }

        .canvas-shape {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .canvas-image {
            display: block;
        }

        /* –ö–æ–Ω—Ç—Ä–æ–ª—ã –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è */
        .zoom-controls {
            position: absolute;
            right: 25px;
            bottom: 25px;
            display: flex;
            gap: 12px;
            z-index: 50;
        }

        .zoom-btn {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 22px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            border: none;
            transition: all 0.3s;
        }

        .zoom-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        .zoom-level {
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            padding: 0 18px;
            border-radius: 25px;
            font-size: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            min-width: 90px;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∑–∞–¥–Ω–µ–≥–æ —Ñ–æ–Ω–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –¥–∏–∞–ª–æ–≥–∞ */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.6);
            z-index: 999;
            display: none;
            backdrop-filter: blur(4px);
        }

        /* –°–∫—Ä—ã—Ç—ã–π —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤ */
        #file-input {
            display: none;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è */
        .delete-button {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            margin-top: 15px;
            transition: all 0.3s;
            color: white;
            border: none;
            padding: 12px 18px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 15px;
            width: 100%;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .delete-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }

        /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø–∞–Ω–µ–ª–∏ —Å–≤–æ–π—Å—Ç–≤ */
        .properties-header {
            margin-bottom: 25px;
            font-size: 20px;
            font-weight: 600;
            color: #ecf0f1;
            padding-bottom: 12px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            background: linear-gradient(45deg, #ff7e5f, #feb47b);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        /* –°–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ */
        .no-selection-message {
            color: #bdc3c7;
            font-style: italic;
            text-align: center;
            margin-top: 50px;
            padding: 25px;
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            border: 1px dashed rgba(255, 255, 255, 0.2);
        }
        
        /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –≤ –ø–∞–Ω–µ–ª–∏ —Å–≤–æ–π—Å—Ç–≤ */
        .property-btn-group {
            display: flex;
            gap: 12px;
        }
        
        .property-btn {
            flex: 1;
            padding: 10px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            background-color: rgba(255, 255, 255, 0.1);
            color: #ecf0f1;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .property-btn:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <!-- –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ -->
        <div class="sidebar">
            <div class="logo">–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –º–∞–∫–µ—Ç–∞</div>
            <button class="tool-button" id="create-text">
                <i>‚úèÔ∏è</i> –°–æ–∑–¥–∞—Ç—å —Ç–µ–∫—Å—Ç
            </button>
            <button class="tool-button" id="create-shape">
                <i>üî∑</i> –î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–≥—É—Ä—É
            </button>
            <button class="tool-button" id="import-image">
                <i>üñºÔ∏è</i> –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            </button>
            <input type="file" id="file-input" accept="image/*">
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π —Ö–æ–ª—Å—Ç -->
        <div class="canvas-container" id="canvas-container">
            <div class="canvas" id="canvas"></div>
            
            <!-- –ö–æ–Ω—Ç—Ä–æ–ª—ã –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è -->
            <div class="zoom-controls">
                <button class="zoom-btn" id="zoom-out">-</button>
                <div class="zoom-level" id="zoom-level">100%</div>
                <button class="zoom-btn" id="zoom-in">+</button>
            </div>
        </div>

        <!-- –ü–∞–Ω–µ–ª—å —Å–≤–æ–π—Å—Ç–≤ –æ–±—ä–µ–∫—Ç–∞ (—Å–ø—Ä–∞–≤–∞) -->
        <div class="properties-panel" id="properties-panel">
            <div class="properties-header">–°–≤–æ–π—Å—Ç–≤–∞ —ç–ª–µ–º–µ–Ω—Ç–∞</div>
            <div class="no-selection-message" id="no-selection-message">
                –í—ã–±–µ—Ä–∏—Ç–µ —ç–ª–µ–º–µ–Ω—Ç –Ω–∞ —Ö–æ–ª—Å—Ç–µ, —á—Ç–æ–±—ã –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –µ–≥–æ —Å–≤–æ–π—Å—Ç–≤–∞
            </div>
            <div id="properties-content"></div>
        </div>
    </div>

    <!-- –î–∏–∞–ª–æ–≥–æ–≤–æ–µ –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ —Ñ–∏–≥—É—Ä -->
    <div class="overlay" id="overlay"></div>
    <div class="shapes-dialog" id="shapes-dialog">
        <div class="dialog-header">
            <div class="dialog-title">–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∏–≥—É—Ä—É</div>
            <button class="close-dialog" id="close-shapes-dialog">&times;</button>
        </div>
        <div class="shapes-list">
            <div class="shape-item" data-shape="rectangle">
                <div class="shape-preview">
                    <div style="width: 60px; height: 40px; background: linear-gradient(45deg, #3498db, #2980b9); border-radius: 5px;"></div>
                </div>
                <div class="shape-name">–ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫</div>
            </div>
            <div class="shape-item" data-shape="circle">
                <div class="shape-preview">
                    <div style="width: 50px; height: 50px; background: linear-gradient(45deg, #2ecc71, #27ae60); border-radius: 50%;"></div>
                </div>
                <div class="shape-name">–ö—Ä—É–≥</div>
            </div>
            <div class="shape-item" data-shape="triangle">
                <div class="shape-preview">
                    <svg width="60" height="60" viewBox="0 0 100 100" preserveAspectRatio="none">
                        <polygon points="50,0 0,100 100,100" fill="url(#triangleGradient)" />
                        <defs>
                            <linearGradient id="triangleGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" stop-color="#e74c3c" />
                                <stop offset="100%" stop-color="#c0392b" />
                            </linearGradient>
                        </defs>
                    </svg>
                </div>
                <div class="shape-name">–¢—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫</div>
            </div>
            <div class="shape-item" data-shape="ellipse">
                <div class="shape-preview">
                    <div style="width: 60px; height: 40px; background: linear-gradient(45deg, #f39c12, #e67e22); border-radius: 50%;"></div>
                </div>
                <div class="shape-name">–≠–ª–ª–∏–ø—Å</div>
            </div>
            <div class="shape-item" data-shape="star">
                <div class="shape-preview">
                    <svg width="50" height="50" viewBox="0 0 24 24">
                        <path d="M12 0l3.09 6.26L22 7.27l-5 4.87 1.18 6.88L12 16l-6.18 3.02L7 12.14 2 7.27l6.91-1.01L12 0z" fill="url(#starGradient)"/>
                        <defs>
                            <linearGradient id="starGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" stop-color="#9b59b6" />
                                <stop offset="100%" stop-color="#8e44ad" />
                            </linearGradient>
                        </defs>
                    </svg>
                </div>
                <div class="shape-name">–ó–≤–µ–∑–¥–∞</div>
            </div>
            <div class="shape-item" data-shape="hexagon">
                <div class="shape-preview">
                    <svg width="50" height="50" viewBox="0 0 24 24">
                        <path d="M21,12l-4.5,7.8L7.5,19.8L3,12l4.5-7.8L16.5,4.2L21,12z" fill="url(#hexagonGradient)"/>
                        <defs>
                            <linearGradient id="hexagonGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" stop-color="#1abc9c" />
                                <stop offset="100%" stop-color="#16a085" />
                            </linearGradient>
                        </defs>
                    </svg>
                </div>
                <div class="shape-name">–®–µ—Å—Ç–∏—É–≥–æ–ª—å–Ω–∏–∫</div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // –û—Å–Ω–æ–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
            const canvas = document.getElementById('canvas');
            const canvasContainer = document.getElementById('canvas-container');
            const propertiesPanel = document.getElementById('properties-panel');
            const propertiesContent = document.getElementById('properties-content');
            const noSelectionMessage = document.getElementById('no-selection-message');
            const createTextBtn = document.getElementById('create-text');
            const createShapeBtn = document.getElementById('create-shape');
            const importImageBtn = document.getElementById('import-image');
            const fileInput = document.getElementById('file-input');
            const shapesDialog = document.getElementById('shapes-dialog');
            const overlay = document.getElementById('overlay');
            const closeShapesDialogBtn = document.getElementById('close-shapes-dialog');
            const shapeItems = document.querySelectorAll('.shape-item');
            const zoomInBtn = document.getElementById('zoom-in');
            const zoomOutBtn = document.getElementById('zoom-out');
            const zoomLevelDisplay = document.getElementById('zoom-level');

            // –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
            let selectedElement = null;
            let isDragging = false;
            let isResizing = false;
            let currentResizeHandle = '';
            let startX, startY;
            let startWidth, startHeight;
            let startLeft, startTop;
            let elements = [];
            let nextId = 1;
            let zoomLevel = 1; // 100%
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ö–æ–ª—Å—Ç–∞
            function initCanvas() {
                canvas.addEventListener('click', handleCanvasClick);
                canvas.addEventListener('mousedown', handleElementMouseDown);
            }
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ –ø–æ —Ö–æ–ª—Å—Ç—É (—Å–Ω—è—Ç–∏–µ –≤—ã–¥–µ–ª–µ–Ω–∏—è)
            function handleCanvasClick(e) {
                if (e.target === canvas) {
                    deselectElement();
                }
            }
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–æ–∫ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è
            zoomInBtn.addEventListener('click', () => {
                zoomLevel = Math.min(zoomLevel + 0.1, 3); // –ú–∞–∫—Å–∏–º—É–º 300%
                updateZoom();
            });
            
            zoomOutBtn.addEventListener('click', () => {
                zoomLevel = Math.max(zoomLevel - 0.1, 0.3); // –ú–∏–Ω–∏–º—É–º 30%
                updateZoom();
            });
            
            function updateZoom() {
                canvas.style.transform = `scale(${zoomLevel})`;
                zoomLevelDisplay.textContent = `${Math.round(zoomLevel * 100)}%`;
            }
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –∫–Ω–æ–ø–æ–∫ —Å–æ–∑–¥–∞–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤
            createTextBtn.addEventListener('click', createTextElement);
            createShapeBtn.addEventListener('click', showShapesDialog);
            importImageBtn.addEventListener('click', () => fileInput.click());
            fileInput.addEventListener('change', importImage);
            closeShapesDialogBtn.addEventListener('click', closeShapesDialog);
            
            // –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã —Ñ–∏–≥—É—Ä –≤ –¥–∏–∞–ª–æ–≥–æ–≤–æ–º –æ–∫–Ω–µ –∏ –Ω–∞–∑–Ω–∞—á–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
            shapeItems.forEach(item => {
                item.addEventListener('click', function() {
                    const shapeType = this.getAttribute('data-shape');
                    createShapeElement(shapeType);
                    closeShapesDialog();
                });
            });
            
            // ----------------------------------------
            // –°–æ–∑–¥–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
            // ----------------------------------------
            
            // –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
            function createTextElement() {
                const id = `element-${nextId++}`;
                const textElement = document.createElement('div');
                textElement.id = id;
                textElement.className = 'canvas-element canvas-text';
                textElement.contentEditable = true;
                textElement.style.left = '100px';
                textElement.style.top = '100px';
                textElement.style.color = '#000000';
                textElement.style.fontSize = '18px';
                textElement.style.fontFamily = 'Montserrat';
                textElement.style.width = 'auto';
                textElement.style.minWidth = '120px';
                textElement.style.height = 'auto';
                textElement.style.minHeight = '40px';
                textElement.style.padding = '10px';
                textElement.style.borderRadius = '5px';
                textElement.style.backgroundColor = 'rgba(255, 255, 255, 0.9)';
                textElement.style.boxShadow = '0 2px 10px rgba(0, 0, 0, 0.1)';
                textElement.innerText = '–î–≤–æ–π–Ω–æ–π –∫–ª–∏–∫ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è';
                
                canvas.appendChild(textElement);
                
                const elementData = {
                    id: id,
                    type: 'text',
                    element: textElement
                };
                
                elements.push(elementData);
                selectElement(textElement);
                
                return textElement;
            }
            
            // –°–æ–∑–¥–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞-—Ñ–∏–≥—É—Ä—ã
            function createShapeElement(shapeType) {
                const id = `element-${nextId++}`;
                const shapeElement = document.createElement('div');
                shapeElement.id = id;
                shapeElement.className = 'canvas-element canvas-shape';
                shapeElement.style.left = '150px';
                shapeElement.style.top = '150px';
                shapeElement.style.width = '120px';
                shapeElement.style.height = '120px';
                shapeElement.style.boxShadow = '0 4px 15px rgba(0, 0, 0, 0.2)';
                
                let backgroundColor = getRandomGradient();
                
                switch(shapeType) {
                    case 'rectangle':
                        shapeElement.style.background = backgroundColor;
                        shapeElement.style.borderRadius = '8px';
                        break;
                    case 'circle':
                        shapeElement.style.background = backgroundColor;
                        shapeElement.style.borderRadius = '50%';
                        break;
                    case 'triangle':
                        shapeElement.innerHTML = `
                            <svg width="100%" height="100%" viewBox="0 0 100 100" preserveAspectRatio="none">
                                <polygon points="50,0 0,100 100,100" fill="${backgroundColor}" />
                            </svg>
                        `;
                        break;
                    case 'ellipse':
                        shapeElement.style.background = backgroundColor;
                        shapeElement.style.borderRadius = '50%';
                        shapeElement.style.height = '80px';
                        break;
                    case 'star':
                        shapeElement.innerHTML = `
                            <svg width="100%" height="100%" viewBox="0 0 50 50" preserveAspectRatio="none">
                                <polygon points="25,5 10,40 40,20 10,20 40,40" fill="${backgroundColor}" />
                            </svg>
                        `;
                        break;
                    case 'hexagon':
                        shapeElement.innerHTML = `
                            <svg width="100%" height="100%" viewBox="0 0 100 100" preserveAspectRatio="none">
                                <polygon points="25,0 75,0 100,50 75,100 25,100 0,50" fill="${backgroundColor}" />
                            </svg>
                        `;
                        break;
                    default:
                        shapeElement.style.background = backgroundColor;
                }
                
                canvas.appendChild(shapeElement);
                
                const elementData = {
                    id: id,
                    type: 'shape',
                    shape: shapeType,
                    element: shapeElement,
                    color: backgroundColor
                };
                
                elements.push(elementData);
                selectElement(shapeElement);
                
                return shapeElement;
            }
            
            // –ò–º–ø–æ—Ä—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
            function importImage(e) {
                if (e.target.files && e.target.files[0]) {
                    const file = e.target.files[0];
                    const reader = new FileReader();
                    
                    reader.onload = function(event) {
                        const id = `element-${nextId++}`;
                        const imageElement = document.createElement('img');
                        imageElement.id = id;
                        imageElement.className = 'canvas-element canvas-image';
                        imageElement.src = event.target.result;
                        imageElement.style.left = '150px';
                        imageElement.style.top = '150px';
                        imageElement.style.width = '200px';
                        imageElement.style.height = 'auto';
                        imageElement.style.borderRadius = '8px';
                        imageElement.style.boxShadow = '0 4px 15px rgba(0, 0, 0, 0.2)';
                        
                        canvas.appendChild(imageElement);
                        
                        const elementData = {
                            id: id,
                            type: 'image',
                            element: imageElement
                        };
                        
                        elements.push(elementData);
                        selectElement(imageElement);
                        
                        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º input, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ç–æ—Ç –∂–µ —Ñ–∞–π–ª –ø–æ–≤—Ç–æ—Ä–Ω–æ
                        fileInput.value = '';
                    };
                    
                    reader.readAsDataURL(file);
                }
            }
            
            // ----------------------------------------
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–¥–µ–ª–µ–Ω–∏—è –∏ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤
            // ----------------------------------------
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç
            function handleElementMouseDown(e) {
                if (e.target.classList.contains('resize-handle')) {
                    // –ù–∞—á–∏–Ω–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞
                    startResizing(e);
                    return;
                }
                
                const element = findElementFromEvent(e);
                if (!element) return;
                
                // –ï—Å–ª–∏ –Ω–∞–∂–∞–ª–∏ –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç - –≥–æ—Ç–æ–≤–∏–º—Å—è –∫ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—é
                if (element !== canvas) {
                    if (element !== selectedElement) {
                        selectElement(element);
                    }
                    
                    startDragging(e);
                }
            }
            
            // –ù–∞—á–∞–ª–æ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–∞
            function startDragging(e) {
                isDragging = true;
                startX = e.clientX;
                startY = e.clientY;
                
                const style = window.getComputedStyle(selectedElement);
                startLeft = parseFloat(style.left);
                startTop = parseFloat(style.top);
                
                document.addEventListener('mousemove', handleDragging);
                document.addEventListener('mouseup', stopDragging);
            }
            
            // –ü—Ä–æ—Ü–µ—Å—Å –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è
            function handleDragging(e) {
                if (!isDragging) return;
                
                const dx = e.clientX - startX;
                const dy = e.clientY - startY;
                
                selectedElement.style.left = `${startLeft + dx}px`;
                selectedElement.style.top = `${startTop + dy}px`;
            }
            
            // –û–∫–æ–Ω—á–∞–Ω–∏–µ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è
            function stopDragging() {
                isDragging = false;
                document.removeEventListener('mousemove', handleDragging);
                document.removeEventListener('mouseup', stopDragging);
            }
            
            // –ù–∞—á–∞–ª–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞
            function startResizing(e) {
                isResizing = true;
                currentResizeHandle = e.target.className.split(' ')[1]; // –ø–æ–ª—É—á–∞–µ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (top-left, bottom-right –∏ —Ç.–¥.)
                startX = e.clientX;
                startY = e.clientY;
                
                const style = window.getComputedStyle(selectedElement);
                startLeft = parseFloat(style.left);
                startTop = parseFloat(style.top);
                startWidth = selectedElement.offsetWidth;
                startHeight = selectedElement.offsetHeight;
                
                document.addEventListener('mousemove', handleResizing);
                document.addEventListener('mouseup', stopResizing);
            }
            
            // –ü—Ä–æ—Ü–µ—Å—Å –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞
            function handleResizing(e) {
                if (!isResizing) return;
                
                const dx = e.clientX - startX;
                const dy = e.clientY - startY;
                
                let newWidth = startWidth;
                let newHeight = startHeight;
                let newLeft = startLeft;
                let newTop = startTop;
                
                if (currentResizeHandle.includes('right')) {
                    newWidth = startWidth + dx;
                } 
                if (currentResizeHandle.includes('bottom')) {
                    newHeight = startHeight + dy;
                }
                if (currentResizeHandle.includes('left')) {
                    newWidth = startWidth - dx;
                    newLeft = startLeft + dx;
                }
                if (currentResizeHandle.includes('top')) {
                    newHeight = startHeight - dy;
                    newTop = startTop + dy;
                }
                
                // –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã
                const minSize = 30;
                if (newWidth >= minSize) {
                    selectedElement.style.width = `${newWidth}px`;
                    selectedElement.style.left = `${newLeft}px`;
                }
                if (newHeight >= minSize) {
                    selectedElement.style.height = `${newHeight}px`;
                    selectedElement.style.top = `${newTop}px`;
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø–∞–Ω–µ–ª—å —Å–≤–æ–π—Å—Ç–≤ —Å –Ω–æ–≤—ã–º–∏ —Ä–∞–∑–º–µ—Ä–∞–º–∏
                updatePropertiesPanel();
            }
            
            // –û–∫–æ–Ω—á–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞
            function stopResizing() {
                isResizing = false;
                document.removeEventListener('mousemove', handleResizing);
                document.removeEventListener('mouseup', stopResizing);
            }
            
            // –ü–æ–∏—Å–∫ —ç–ª–µ–º–µ–Ω—Ç–∞ –∏–∑ —Å–æ–±—ã—Ç–∏—è
            function findElementFromEvent(e) {
                let target = e.target;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Ü–µ–ª—å –∏–ª–∏ –µ—ë —Ä–æ–¥–∏—Ç–µ–ª–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–º canvas-element
                while (target && !target.classList.contains('canvas-element')) {
                    if (target === canvas) return target;
                    target = target.parentElement;
                }
                
                return target;
            }
            
            // ----------------------------------------
            // –†–∞–±–æ—Ç–∞ —Å –≤—ã–¥–µ–ª–µ–Ω–∏–µ–º —ç–ª–µ–º–µ–Ω—Ç–∞
            // ----------------------------------------
            
            // –í—ã–¥–µ–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞
            function selectElement(element) {
                if (selectedElement) {
                    deselectElement();
                }
                
                selectedElement = element;
                element.classList.add('selected');
                
                // –î–æ–±–∞–≤–ª—è–µ–º –º–∞—Ä–∫–µ—Ä—ã-—Ö–µ–Ω–¥–ª–µ—Ä—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞
                addResizeHandles(element);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø–∞–Ω–µ–ª—å —Å–≤–æ–π—Å—Ç–≤
                updatePropertiesPanel();
                noSelectionMessage.style.display = 'none';
            }
            
            // –°–Ω—è—Ç–∏–µ –≤—ã–¥–µ–ª–µ–Ω–∏—è
            function deselectElement() {
                if (selectedElement) {
                    selectedElement.classList.remove('selected');
                    removeResizeHandles();
                    selectedElement = null;
                    noSelectionMessage.style.display = 'block';
                    propertiesContent.innerHTML = '';
                }
            }
            
            // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ä–∫–µ—Ä–æ–≤-—Ö–µ–Ω–¥–ª–µ—Ä–æ–≤ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞
            function addResizeHandles(element) {
                const handles = ['top-left', 'top-right', 'bottom-left', 'bottom-right'];
                
                // –°–Ω–∞—á–∞–ª–∞ —É–¥–∞–ª—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ö–µ–Ω–¥–ª–µ—Ä—ã, –µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å
                removeResizeHandles();
                
                // –ó–∞—Ç–µ–º —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–µ
                handles.forEach(position => {
                    const handle = document.createElement('div');
                    handle.className = `resize-handle ${position}`;
                    element.appendChild(handle);
                });
            }
            
            // –£–¥–∞–ª–µ–Ω–∏–µ –º–∞—Ä–∫–µ—Ä–æ–≤-—Ö–µ–Ω–¥–ª–µ—Ä–æ–≤
            function removeResizeHandles() {
                const handles = document.querySelectorAll('.resize-handle');
                handles.forEach(handle => handle.remove());
            }
            
            // ----------------------------------------
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞–Ω–µ–ª–∏ —Å–≤–æ–π—Å—Ç–≤
            // ----------------------------------------
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞–Ω–µ–ª–∏ —Å–≤–æ–π—Å—Ç–≤ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–º —ç–ª–µ–º–µ–Ω—Ç–æ–º
            function updatePropertiesPanel() {
                if (!selectedElement) return;
                
                propertiesContent.innerHTML = '';
                
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø —ç–ª–µ–º–µ–Ω—Ç–∞
                const elementData = elements.find(e => e.element === selectedElement);
                if (!elementData) return;
                
                // –û–±—â–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞ –¥–ª—è –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
                const sizeGroup = createPropertyGroup('–†–∞–∑–º–µ—Ä—ã');
                
                // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–µ —Ä–∞–∑–º–µ—Ä—ã
                const width = selectedElement.offsetWidth;
                const height = selectedElement.offsetHeight;
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–Ω—Ç—Ä–æ–ª—ã –¥–ª—è —Ä–∞–∑–º–µ—Ä–æ–≤
                const widthControl = createPropertyControl('–®–∏—Ä–∏–Ω–∞ (px)', 'number', 'width-input', width);
                const heightControl = createPropertyControl('–í—ã—Å–æ—Ç–∞ (px)', 'number', 'height-input', height);
                
                sizeGroup.appendChild(widthControl);
                sizeGroup.appendChild(heightControl);
                propertiesContent.appendChild(sizeGroup);
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–Ω—Ç—Ä–æ–ª—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ —ç–ª–µ–º–µ–Ω—Ç–∞
                if (elementData.type === 'text') {
                    // –ì—Ä—É–ø–ø–∞ —Å–≤–æ–π—Å—Ç–≤ —à—Ä–∏—Ñ—Ç–∞
                    const fontGroup = createPropertyGroup('–®—Ä–∏—Ñ—Ç');
                    
                    // –¢–µ–∫—É—â–∏–µ —Å—Ç–∏–ª–∏
                    const style = window.getComputedStyle(selectedElement);
                    const fontSize = parseInt(style.fontSize);
                    const fontFamily = style.fontFamily.split(',')[0].replace(/['"]+/g, '');
                    const color = rgbToHex(style.color);
                    const bgColor = rgbToHex(style.backgroundColor);
                    
                    // –ö–æ–Ω—Ç—Ä–æ–ª—ã –¥–ª—è —Å–≤–æ–π—Å—Ç–≤ —Ç–µ–∫—Å—Ç–∞
                    const fontSizeControl = createPropertyControl('–†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ (px)', 'number', 'font-size-input', fontSize);
                    const fontFamilyControl = createFontFamilyControl(fontFamily);
                    const colorControl = createColorControl('–¶–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞', 'text-color-input', color);
                    const bgColorControl = createColorControl('–¶–≤–µ—Ç —Ñ–æ–Ω–∞', 'bg-color-input', bgColor);
                    
                    fontGroup.appendChild(fontSizeControl);
                    fontGroup.appendChild(fontFamilyControl);
                    fontGroup.appendChild(colorControl);
                    fontGroup.appendChild(bgColorControl);
                    propertiesContent.appendChild(fontGroup);
                    
                    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π
                    document.getElementById('font-size-input').addEventListener('change', function() {
                        selectedElement.style.fontSize = this.value + 'px';
                    });
                    
                    document.getElementById('font-family-input').addEventListener('change', function() {
                        selectedElement.style.fontFamily = this.value;
                    });
                    
                    document.getElementById('text-color-input').addEventListener('change', function() {
                        selectedElement.style.color = this.value;
                    });
                    
                    document.getElementById('bg-color-input').addEventListener('change', function() {
                        selectedElement.style.backgroundColor = this.value;
                    });
                }
                
                if (elementData.type === 'shape') {
                    // –ì—Ä—É–ø–ø–∞ —Å–≤–æ–π—Å—Ç–≤ —Ñ–∏–≥—É—Ä—ã
                    const shapeGroup = createPropertyGroup('–§–∏–≥—É—Ä–∞');
                    
                    // –ü–æ–ª—É—á–∞–µ–º —Ü–≤–µ—Ç —Ñ–∏–≥—É—Ä—ã
                    let color = elementData.color || getRandomGradient();
                    
                    // –ö–æ–Ω—Ç—Ä–æ–ª –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–≤–µ—Ç–∞ —Ñ–∏–≥—É—Ä—ã
                    const colorControl = createColorControl('–¶–≤–µ—Ç —Ñ–∏–≥—É—Ä—ã', 'shape-color-input', color);
                    
                    shapeGroup.appendChild(colorControl);
                    propertiesContent.appendChild(shapeGroup);
                    
                    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–≤–µ—Ç–∞
                    document.getElementById('shape-color-input').addEventListener('change', function() {
                        const newColor = this.value;
                        elementData.color = newColor;
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º —Ü–≤–µ—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ —Ñ–∏–≥—É—Ä—ã
                        if (elementData.shape === 'rectangle' || elementData.shape === 'circle' || elementData.shape === 'ellipse') {
                            selectedElement.style.background = newColor;
                        } else {
                            // –î–ª—è SVG-—Ñ–∏–≥—É—Ä (—Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫, –∑–≤–µ–∑–¥–∞, —à–µ—Å—Ç–∏—É–≥–æ–ª—å–Ω–∏–∫)
                            const svgPolygon = selectedElement.querySelector('polygon');
                            if (svgPolygon) {
                                svgPolygon.setAttribute('fill', newColor);
                            }
                        }
                    });
                }
                
                if (elementData.type === 'image') {
                    // –ì—Ä—É–ø–ø–∞ —Å–≤–æ–π—Å—Ç–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
                    const imageGroup = createPropertyGroup('–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ');
                    
                    // –ö–æ–Ω—Ç—Ä–æ–ª –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–ø–æ—Ä—Ü–∏–π
                    const aspectRatioControl = document.createElement('div');
                    aspectRatioControl.className = 'property-control';
                    
                    const aspectRatioLabel = document.createElement('label');
                    aspectRatioLabel.innerText = '–°–æ—Ö—Ä–∞–Ω—è—Ç—å –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏:';
                    
                    const aspectRatioToggle = document.createElement('input');
                    aspectRatioToggle.type = 'checkbox';
                    aspectRatioToggle.id = 'aspect-ratio-toggle';
                    aspectRatioToggle.checked = selectedElement.style.height === 'auto';
                    
                    aspectRatioLabel.appendChild(aspectRatioToggle);
                    aspectRatioControl.appendChild(aspectRatioLabel);
                    
                    imageGroup.appendChild(aspectRatioControl);
                    propertiesContent.appendChild(imageGroup);
                    
                    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–ø–æ—Ä—Ü–∏–π
                    aspectRatioToggle.addEventListener('change', function() {
                        if (this.checked) {
                            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å—Ç–æ—Ä–æ–Ω (–∞–≤—Ç–æ-–≤—ã—Å–æ—Ç–∞)
                            selectedElement.style.height = 'auto';
                        } else {
                            // –§–∏–∫—Å–∏—Ä—É–µ–º —Ç–µ–∫—É—â—É—é –≤—ã—Å–æ—Ç—É
                            selectedElement.style.height = selectedElement.offsetHeight + 'px';
                        }
                    });
                }
                
                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–æ–≤ –¥–ª—è –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
                document.getElementById('width-input').addEventListener('change', function() {
                    selectedElement.style.width = this.value + 'px';
                });
                
                document.getElementById('height-input').addEventListener('change', function() {
                    selectedElement.style.height = this.value + 'px';
                });
                
                // –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è
                const deleteButton = document.createElement('button');
                deleteButton.className = 'delete-button';
                deleteButton.innerText = '–£–¥–∞–ª–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç';
                deleteButton.addEventListener('click', deleteSelectedElement);
                
                propertiesContent.appendChild(deleteButton);
            }
            
            // –£–¥–∞–ª–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
            function deleteSelectedElement() {
                if (selectedElement) {
                    // –ù–∞—Ö–æ–¥–∏–º –∏–Ω–¥–µ–∫—Å —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ –º–∞—Å—Å–∏–≤–µ
                    const elementIndex = elements.findIndex(e => e.element === selectedElement);
                    
                    if (elementIndex !== -1) {
                        // –£–¥–∞–ª—è–µ–º –∏–∑ DOM
                        selectedElement.remove();
                        
                        // –£–¥–∞–ª—è–µ–º –∏–∑ –º–∞—Å—Å–∏–≤–∞
                        elements.splice(elementIndex, 1);
                        
                        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ
                        deselectElement();
                    }
                }
            }
            
            // –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã —Å–≤–æ–π—Å—Ç–≤
            function createPropertyGroup(title) {
                const group = document.createElement('div');
                group.className = 'property-group';
                
                const titleElement = document.createElement('div');
                titleElement.className = 'property-title';
                titleElement.innerText = title;
                
                group.appendChild(titleElement);
                return group;
            }
            
            // –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª–∞ —Å–≤–æ–π—Å—Ç–≤–∞
            function createPropertyControl(labelText, inputType, inputId, value) {
                const control = document.createElement('div');
                control.className = 'property-control';
                
                const label = document.createElement('label');
                label.innerText = labelText;
                
                const input = document.createElement('input');
                input.type = inputType;
                input.id = inputId;
                input.value = value;
                if (inputType === 'number') {
                    input.min = 10;
                }
                
                control.appendChild(label);
                control.appendChild(input);
                
                return control;
            }
            
            // –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª–∞ –≤—ã–±–æ—Ä–∞ —Ü–≤–µ—Ç–∞
            function createColorControl(labelText, inputId, value) {
                const control = document.createElement('div');
                control.className = 'property-control';
                
                const label = document.createElement('label');
                label.innerText = labelText;
                
                const input = document.createElement('input');
                input.type = 'color';
                input.className = 'color-picker';
                input.id = inputId;
                input.value = value;
                
                control.appendChild(label);
                control.appendChild(input);
                
                return control;
            }
            
            // –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª–∞ –≤—ã–±–æ—Ä–∞ —Å–µ–º–µ–π—Å—Ç–≤–∞ —à—Ä–∏—Ñ—Ç–∞
            function createFontFamilyControl(currentFont) {
                const control = document.createElement('div');
                control.className = 'property-control';
                
                const label = document.createElement('label');
                label.innerText = '–®—Ä–∏—Ñ—Ç:';
                
                const select = document.createElement('select');
                select.id = 'font-family-input';
                
                const fonts = [
                    'Montserrat', 'Arial', 'Verdana', 'Times New Roman', 
                    'Courier New', 'Georgia', 'Tahoma', 'Trebuchet MS',
                    'Roboto', 'Open Sans', 'Lato', 'Poppins'
                ];
                
                fonts.forEach(font => {
                    const option = document.createElement('option');
                    option.value = font;
                    option.innerText = font;
                    if (font === currentFont) {
                        option.selected = true;
                    }
                    select.appendChild(option);
                });
                
                control.appendChild(label);
                control.appendChild(select);
                
                return control;
            }
            
            // ----------------------------------------
            // –î–∏–∞–ª–æ–≥–æ–≤–æ–µ –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ —Ñ–∏–≥—É—Ä
            // ----------------------------------------
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –¥–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ —Ñ–∏–≥—É—Ä
            function showShapesDialog() {
                shapesDialog.style.display = 'block';
                overlay.style.display = 'block';
            }
            
            // –ó–∞–∫—Ä—ã—Ç—å –¥–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ —Ñ–∏–≥—É—Ä
            function closeShapesDialog() {
                shapesDialog.style.display = 'none';
                overlay.style.display = 'none';
            }
            
            // ----------------------------------------
            // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
            // ----------------------------------------
            
            // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ RGB –≤ HEX
            function rgbToHex(rgb) {
                if (rgb.startsWith('#')) return rgb;
                
                // –ò–∑–≤–ª–µ–∫–∞–µ–º —á–∏—Å–ª–∞ –∏–∑ —Å—Ç—Ä–æ–∫–∏ RGB
                const rgbMatch = rgb.match(/^rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i);
                if (!rgbMatch) return '#000000';
                
                function hex(x) {
                    return ('0' + parseInt(x).toString(16)).slice(-2);
                }
                
                return '#' + hex(rgbMatch[1]) + hex(rgbMatch[2]) + hex(rgbMatch[3]);
            }
            
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞
            function getRandomGradient() {
                const colors = [
                    ['#3498db', '#2980b9'], // —Å–∏–Ω–∏–π
                    ['#2ecc71', '#27ae60'], // –∑–µ–ª–µ–Ω—ã–π
                    ['#e74c3c', '#c0392b'], // –∫—Ä–∞—Å–Ω—ã–π
                    ['#f39c12', '#e67e22'], // –æ—Ä–∞–Ω–∂–µ–≤—ã–π
                    ['#9b59b6', '#8e44ad'], // —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π
                    ['#1abc9c', '#16a085']  // –±–∏—Ä—é–∑–æ–≤—ã–π
                ];
                
                const randomColors = colors[Math.floor(Math.random() * colors.length)];
                return `linear-gradient(45deg, ${randomColors[0]}, ${randomColors[1]})`;
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
            initCanvas();
        });
    </script>
</body>
</html>
